import socket
import threading
import time
black = "\033[30m"
red = "\033[31m"
green = "\033[32m" 
yellow = "\033[33m" 
blue = "\033[34m" 
magenta = "\033[35m" 
cyan = "\033[36m" 
white = "\033[37m" 
orange = "\033[38;5;208m"
moonlit = "\033[38;2;116;92;151m"
electric = "\033[38;2;0;255;209m"
reset = "\033[0m"

#ports list
port_names = {
    1: 'TCP Port Service Multiplexer',
    2: 'CompressNET Management Utility',
    3: 'CompressNET Compression Process (Obsolete)',
    4: 'Unknown',
    5: 'Remote Job Entry',
    6: 'Unknown',
    7: 'Echo',
    8: 'Unknown',
    9: 'Discard',
    10: 'unknown',
    11: 'Active Users',
    12: 'Unknown',
    13: 'Daytime',
    14: 'Unknown',
    15: 'Unknown',
    16: 'Unknown',
    17: 'Quote of the Day',
    18: 'Message Send Protocol',
    19: 'Character Generator',
    20: 'FTP (Data)',
    21: 'FTP (Control)',
    22: 'SSH',
    23: 'Telnet',
    24: 'Private Mail System',
    25: 'SMTP',
    26: 'SMTP (Alternate)',
    27: 'NSW User System FE',
    28: 'unknown',
    29: 'MSG ICP',
    30: 'unknown',
    31: 'MSG Authentication',
    32: 'unknown',
    33: 'Display Support Protocol',
    34: 'unknown',
    35: 'Privileged Communication Protocol',
    36: 'TimeShare Terminal Link',
    37: 'Time Protocol',
    38: 'Route Access Protocol',
    39: 'Resource Location Protocol',
    40: 'unknown',
    41: 'Graphics',
    42: 'WINS Replication',
    43: 'WHOIS',
    44: 'MPM FLAGS Protocol',
    45: 'Message Processing Module',
    46: 'MPM (Default Send)',
    47: 'NI-FTP',
    48: 'Digital Audit Daemon',
    49: 'TACACS',
    50: 'Remote Mail Checking Protocol',
    51: 'IMP Logical Address Maintenance',
    52: 'XNS Time Protocol',
    53: 'DNS',
    54: 'XNS Datagram Protocol',
    55: 'ISI Graphics Language',
    56: 'XNS Authentication',
    57: 'XNS Mail Protocol',
    58: 'XNS Time Protocol',
    59: 'Any private use',
    60: 'Unassigned',
    61: 'NI-Mail',
    62: 'ACIS',
    63: 'Send',
    64: 'ACIS-1',
    65: 'ACIS-2',
    66: 'Oracle SQL*Net',
    67: 'DHCP Server',
    68: 'DHCP Client',
    69: 'TFTP',
    70: 'Gopher',
    71: 'NETRJS-1',
    72: 'NETRJS-2',
    73: 'NETRJS-3',
    74: 'NETRJS-4',
    75: 'Privileged File Transfer Protocol',
    76: 'Broadband Access Protocol',
    77: 'Privileged Access Protocol',
    78: 'UTS FTP',
    79: 'Finger',
    80: 'HTTP',
    81: 'HTTP (Alternate)',
    82: 'XFER Utility',
    83: 'MIT ML Device',
    84: 'Common Trace Facility',
    85: 'MIT ML Device (Alternate)',
    86: 'Micro Focus Cobol',
    87: 'Privileged Gateway',
    88: 'Kerberos',
    89: 'SU-MIT-TG',
    90: 'DNSIX',
    91: 'MIT-DMS',
    92: 'Network Printing Protocol',
    93: 'Device Control Protocol',
    94: 'Any private use',
    95: 'SUPDUP',
    96: 'DCP',
    97: 'Mobile IP',
    98: 'Terminix',
    99: 'Metre-OLAP',
    100: 'New RFC-1000 Port',
    101: 'POP3',
    102: 'ISO-TSAP',
    103: 'X.400',
    104: 'MAC Address Control',
    105: '5eL-RES-VR',
    106: 'FS-MULTICAST',
    107: 'SNMP v2',
    108: 'X.25 PAD',
    109: 'POP2',
    110: 'POP3',
    111: 'RPC Bind / portmap',
    112: 'AVR (Autonomous Vehicle Radio)',
    113: 'Ident',
    114: 'AUDIX',
    115: 'ANSWERSERVER',
    116: 'Kermit',
    117: 'UUCP Path Service',
    118: 'SQL Services',
    119: 'NNTP',
    120: 'SQL NET',
    121: 'ERPCOMM',
    122: 'SMT (Simple Message Transfer)',   123: 'NTP (Network Time Protocol)',
    124: 'CERP (CORBA External Interface Protocol)',
    125: 'LDP (Label Distribution Protocol)',  
    126: 'Mindterm',
    127: 'Canara',
    128: 'GSSAPI',
    129: 'Amdocs',
    130: 'NetWare Core Protocol (NCP)',
    131: 'Intergraph',
    132: 'ARAP',
    133: 'NORM',
    134: 'Multi-Protocol',
    135: 'Microsoft RPC',
    136: 'MS RPC (Microsoft Remote Procedure Call)',
    137: 'NetBIOS Name Service',
    138: 'NetBIOS Datagram',
    139: 'NetBIOS Session',
    140: 'EMACS',
    141: 'COMPRESSNET',
    142: 'COMSAT',
    143: 'IMAP',
    144: 'NEC Corporation',
    145: 'ISO-TP4',
    146: 'ISO-IP',
    147: 'ISO-CLNP',
    148: 'EMAP',
    149: 'SQL Services (SQL Server)',
    150: 'NetWare over IPX',
    151: 'Windows Messenger',
    152: 'BFTP (Binary File Transfer Protocol)',
    153: 'NSW User System',
    154: 'MARS',
    155: 'RFE (Remote File Exchange)',
    156: 'STUBB',
    157: 'X.25',
    158: 'CATCHER',
    159: 'NLM-Auth',
    160: 'LDP (Label Distribution Protocol)',
    161: 'SNMP',
    162: 'SNMP Trap',
    163: 'CMIP/TCP',
    164: 'SMB',
    165: 'X.25 Packet Layer Protocol',
    166: 'X.25 Virtual Circuit Network Protocol',
    167: 'Signalling System 7 (SS7)',
    168: 'Network Time Protocol',
    169: 'NMSP (Network Management Protocol)',
    170: 'Remote Network Monitoring Protocol',
    171: 'PPPOE',
    172: 'ISO-IR-TEST',
    173: 'Transparent Interprocess Communication',
    174: 'MHS',
    175: 'ISO-IP',
    176: 'SLP (Service Location Protocol)',
    177: 'XDMCP',
    178: 'NextStep Window Server',
    179: 'BGP',
    194: 'IRC',
    180: 'Intergraph',
    181: 'Unify',
    182: 'AOL',
    183: 'Oracle Naming',
    184: 'Remote-KIS',
    185: 'Remote-KIS',
    186: 'Terminal Access Controller Access-Control System (TACACS)',
    187: 'Local Link Name Resolution (LLNR)',
    188: 'Plus Five',
    189: 'Queued File Transport',
    190: 'Gateway Access Control Protocol (GACP)',
    191: 'Prospero Directory Service',
    192: 'OSU Network Monitoring System',
    193: 'Amplitude Modulation Sound Protocol',
    194: 'IRC (Internet Relay Chat)',
    195: 'DNSIX Network Level Module Audit',
    196: 'DNSIX Session Mgt Module Audit Redir',
    197: 'Directory Location Service',
    198: 'Directory Location Service Monitor',
    199: 'SMUX (SNMP Unix Multiplexer)',
    200: 'IBM System Resource Controller',
    201: 'AppleTalk',
    202: 'AppleTalk Routing Maintenance',
    203: 'AppleTalk Echo Protocol',
    204: 'AppleTalk Zone Information Protocol',
    205: 'AppleTalk Name Binding Protocol',
    206: 'AppleTalk Datagram Delivery Protocol',
    207: 'AppleTalk Transaction Protocol',
    208: 'AppleTalk Name Binding Protocol (NBP)',
    209: 'Quick Mail Transfer Protocol',
    210: 'ANSI Z39.50',
    211: 'Texas Instruments 914C/G Terminal',
    212: 'ATEXSSTR',
    213: 'IPX',
    214: 'VMNET',
    215: 'UMSP',
    216: 'SNS Distribution Manager',
    217: 'SNS Console Manager',
    218: 'MHS X.400',
    219: 'Directory Services',
    220: 'Internet Message Access Protocol v3 (IMAP3)',
    221: 'Berkeley rlogind with SPX Auth',
    222: 'Berkeley rshd with SPX Auth',
    223: 'Certificate Distribution Center',
    224: 'MASQDIALER',
    225: 'Directory Server XDS',
    226: 'Oracle Gateway',
    227: 'Oracle Presentation',
    228: 'Oracle CMan',
    229: 'Oracle Metric Server',
    230: 'Oracle Connection Manager',
    231: 'ICC',
    232: 'EPMAP (DCE endpoint resolution)',
    233: 'SRMP',
    234: 'New Reality',
    235: 'HostAlias',
    236: 'Service Location Protocol v2',
    237: 'IEE',
    238: 'Oracle Service',
    239: 'Gatekeeper',
    240: 'DLS',
    241: 'Adapt',
    242: 'Direct',
    243: 'Survey',
    244: 'Infinet',
    245: 'LINK',
    246: 'Display',
    247: 'SUBNET',
    248: 'BROWSER',
    249: 'FileSystem',
    250: 'Reserve',
    251: 'Reserve',
    252: 'Reserve',
    253: 'Trunk',
    254: 'Trunk',
    255: 'Trunk',
    256: 'RAP',
    257: 'SET',
    258: 'Yak Winsock Personal Chat',
    259: 'ESRO',
    260: 'OpenPort',
    261: 'NSIIOPS',
    262: 'Arcisdms',
    263: 'HDAP',
    264: 'BGMP',
    265: 'SNS Dispatch Manager',
    266: 'ONTIME',
    267: 'Multiplex',
    268: 'GNUnet',
    269: 'Cadis-1',
    270: 'Cadis-2',
    271: 'Flexible License Manager',
    272: 'HTTP-MGMT',
    273: 'Survey Measurement',
    274: 'NEC Remote Management',
    275: 'DataView Browser',
    276: 'SubNet Services',
    277: 'SRA',
    278: 'Media Gateway Control Protocol  (MGCP)',
    279: 'Personal Link',
    280: 'http-mgmt',
    281: 'AFTP',
    282: 'PIPE',
    283: 'Dev Analyzer',
    284: 'K-Broker',
    285: 'MetaConsole',
    286: 'SDP Port Mapper Protocol',
    287: 'DXE',
    288: 'FWAG Control Protocol',
    289: 'Calendar Access Protocol',
    290: 'Cardbox',
    291: 'ESMTP',
    292: 'UDP Port Service',
    293: 'Chatroom',
    294: 'BGMP',
    295: 'FWAG Control Protocol',
    296: 'ListProcessor',
    297: 'Display Support Protocol',
    298: 'MediaSpace',
    299: 'Asip-WebAdmin',
    300: 'Ping-Pong Protocol',
    301: 'Telerate',
    302: 'RCIP-ITCP',
    303: 'Arepa-RA',
    304: 'NSIIOPS',
    305: 'SNS Admin',
    306: 'URS',
    307: 'Event-Listener',
    308: 'Novastor Backup',
    309: 'EntrustTime',
    310: 'Bhmds',
    311: 'AppleShare IP WebAdmin',
    312: 'VSLMP',
    313: 'Magenta Logic',
    314: 'Opalis Robot',
    315: 'DPSI',
    316: 'DECAuth',
    317: 'Zannet',
    318: 'TSP',
    319: 'PTP Event',
    320: 'PTP General',
    321: 'PIP',
    322: 'RTSPS',
    323: 'IMMP',
    324: 'VMPWSCS',
    325: 'RSVP Port',
    326: 'Reserved',
    327: 'Reserved',
    328: 'Reserved',
    329: 'Reserved',
    330: 'Reserved',
    331: 'Reserved',
    332: 'Reserved',
    333: 'Texar Security Port',
    334: 'Reserved',
    335: 'Reserved',
    336: 'Reserved',
    337: 'Reserved',
    338: 'MSN',
    339: 'Reserved',
    340: 'Reserved',
    341: 'Reserved',
    342: 'Reserved',
    343: 'Reserved',
    344: 'Reserved',
    345: 'Reserved',
    346: 'Reserved',
    347: 'FATSERV',
    348: 'CSI-SGWP',
    349: 'MFTP',
    350: 'MATIP Type A',
    351: 'MATIP Type B',
    352: 'DTAG',
    353: 'NDSAUTH',
    354: 'BH611',
    355: 'DATEX-ASN',
    356: 'Cloanto-Net',
    357: 'bhevent',
    358: 'Shrinkwrap',
    359: 'Tenebris',
    360: 'scoi2odialog',
    361: 'Semantix',
    362: 'SRS Send',
    363: 'RSVP Tunnel',
    364: 'Aurora CMGR',
    365: 'DTK',
    366: 'ODMR',
    367: 'MortgageWare',
    368: 'QbikGDP',
    369: 'rpc2portmap',
    370: 'codaauth2',
    371: 'ClearCase',
    372: 'ListProcessor',
    373: 'Legent Corporation',
    374: 'Legent Corporation',
    375: 'Hassle',
    376: 'Amiga Envoy',
    377: 'NEC Corporation',
    378: 'NEC Corporation',
    379: 'TIA/EIA/IS-99',
    380: 'TIA/EIA/IS-99',
    381: 'HP OpenView',
    382: 'HP OpenView',
    383: 'HP OpenView',
    384: 'A Remote Network Server System',
    385: 'IBM Application',
    386: 'ASA',
    387: 'Appletalk Update-Based Routing (AURP)',
    388: 'Unidata LDM',
    389: 'LDAP',
    390: 'UIS',
    391: 'SynOptics SNMP Relay Port',
    392: 'SynOptics Port',
    393: 'Meta5',
    394: 'EMBL Nucleic Data Transfer',
    395: 'NETcp',
    396: 'Novell Netware over IP',
    397: 'Multi Protocol Trans. Net',
    398: 'Kryptolan',
    399: 'ISO Transport Class 4',
    400: 'Workstation Solutions',
    401: 'Uninterruptible Power Supply',
    402: 'Genie',
    403: 'decap',
    404: 'nced',
    405: 'ncld',
    406: 'Interactive Mail Support Protocol',
    407: 'Timbuktu',
    408: 'Prospero Resource Manager',
    409: 'Prospero Resource Manager Node',
    410: 'DECLadebug Remote Debug Protocol',
    411: 'Remote MT Protocol',
    412: 'Trap Convention Port',
    413: 'SMSP',
    414: 'InfoSeek',
    415: 'BNet',
    416: 'Silverplatter',
    417: 'Onmux',
    418: 'Hyper-G',
    419: 'Ariel',
    420: 'SMPTE',
    421: 'Ariel 1',
    422: 'Ariel 2',
    423: 'IBM Operations Planning and Control Start',
    424: 'IBM Operations Planning and Control Track',
    425: 'ICAD',
    426: 'smartsdp',
    427: 'SLP',
    428: 'OCS_CMU',
    429: 'OCS_AMU',
    430: 'UTMPSD',
    431: 'UTMPCD',
    432: 'IASD',
    433: 'NNTP (reserved)',
    434: 'MobileIP-Agent',
    435: 'MobilIP-MN',
    436: 'DNA-CML',
    437: 'comscm',
    438: 'dsfgw',
    439: 'dasp',
    440: 'sgcp',
    441: 'decvms-sysmgt',
    442: 'cvc_hostd',
    443: 'HTTPS',
    444: 'Simple Network Paging Protocol (SNPP)',
    445: 'Microsoft-DS (SMB)',
    446: 'DDM-Remote Relational Database Access',
    447: 'DDM-Distributed File Management',
    448: 'DDM-Remote DB Access Using Secure Sockets',
    449: 'AS Server Mapper',
    450: 'TServer',
    451: 'Cray Network Semaphore Server',
    452: 'Cray SFS Config Server',
    453: 'CreativeServer',
    454: 'ContentServer',
    455: 'CreativePartnr',
    456: 'macon',
    457: 'scohelp',
    458: 'apple quick time',
    459: 'ampr-rcmd',
    460: 'skronk',
    461: 'DataRampSrv',
    462: 'DataRampSrvSec',
    463: 'alpes',
    464: 'Kerberos Change/Set Password',
    465: 'SMTPS',
    466: 'digital-vrc',
    467: 'mylex-mapd',
    468: 'photuris',
    469: 'rcp',
    470: 'scx-proxy',
    471: 'Mondex',
    472: 'ljk-login',
    473: 'hybrid-pop',
    474: 'tn-tl-w1',
    475: 'tcpnethaspsrv',
    476: 'tn-tl-fd1',
    477: 'ss7ns',
    478: 'spsc',
    479: 'iafserver',
    480: 'iafdbase',
    481: 'Ph service',
    482: 'bgs-nsi',
    483: 'ulpnet',
    484: 'Integra Software Management Environment (Integra SME)',
    485: 'Air Soft Power Burst',
    486: 'avian',
    487: 'saft Simple Asynchronous File Transfer',
    488: 'gss-http',
    489: 'nest-protocol',
    490: 'micom-pfs',
    491: 'GO-Global remote access',
    492: 'Transport Independent Convergence for FNA',
    493: 'Transport Independent Convergence for FNA',
    494: 'POV-Ray',
    495: 'intecourier',
    496: 'PIM-RP-DISC',
    497: 'Retrospect',
    498: 'siam',
    499: 'iso-ill',
    500: 'ISAKMP (IPSec)',
    501: 'STMF',
    502: 'Modbus',
    503: 'Intrinsa',
    504: 'citadel',
    505: 'mailbox-lm',
    506: 'ohimsrv',
    507: 'crs',
    508: 'xvttp',
    509: 'snare',
    510: 'wait',
    511: 'execsrv',
    512: 'exec',
    513: 'login',
    514: 'Shell / Syslog',
    515: 'Printer',
    516: 'videotex',
    517: 'talk',
    518: 'ntalk',
    519: 'utime',
    520: 'RIP',
    521: 'ripng',
    522: 'ULP',
    523: 'IBSMP',
    524: 'NCP',
    525: 'Direct',
    526: 'Tempo',
    527: 'Striker',
    528: 'Unknown',
    529: 'Many-to-One Remote',
    530: 'RPC',
    531: 'IRC Shadow',
    532: 'Netnews',
    533: 'Couriers',
    534: 'Unknown',
    535: 'Mail Transfer Agent',
    536: 'Profile',
    537: 'Unknown',
    538: 'UUCP Path Service',
    539: 'Unknown',
    540: 'UUCP',
    541: 'Mobile User System',
    542: 'Commerce',
    543: 'Unknown',
    544: 'Unknown',
    545: 'Unknown',
    546: 'DHCPv6 Client',
    547: 'DHCPv6 Server',
    548: 'Unknown',
    549: 'Unknown',
    550: 'Unknown',
    551: 'Unknown',
    552: 'Unknown',
    553: 'Unknown',
    554: 'RTSP',
    555: 'DSF',
    556: 'Remotefs',
    557: 'OpenVMS SYSLOG',
    558: 'SDNSKMP',
    559: 'TEEDTAP',
    560: 'rmonitor',
    561: 'monitor',
    562: 'chshell',
    563: 'NNTP over SSL',
    564: 'Plan 9 file service',
    565: 'Whoami',
    566: 'Streettalk',
    567: 'banyan-rpc',
    568: 'Microsoft SHIVA',
    569: 'MS-RPC',
    570: 'monitor',
    571: 'udp_echo',
    572: 'udp_echo',
    573: 'SWAT',
    574: 'Acantha',
    575: 'DCP',
    576: 'VMPS',
    577: 'VFO',
    578: 'SUN DR',
    579: 'METAGRAM',
    580: 'Hypertext Cache Protocol',
    581: 'Bundle Discovery Protocol',
    582: 'SCC Security',
    583: 'Philips Video-Conferencing',
    584: 'Key Server',
    585: 'IMAP4+SSL',
    586: 'Password Change',
    587: 'SMTP Submission',
    588: 'CAL',
    589: 'EyeLink',
    590: 'TNS CML', 
    591: 'FileMaker Inc. - HTTP Alternate',
    592: 'Eudora Set',
    593: 'RPC over HTTP',
    594: 'TIPC',
    595: 'CryptoAdmin',
    596: 'Unknown',
    597: 'Unknown',
    598: 'SCO Web Server Manager 3',
    599: 'Aeolon Core Protocol',
    600: 'Sun IPC server',
    601: 'Reliable Syslog Service',
    602: 'XML-RPC over BEEP',
    603: 'IDXP',
    604: 'TUNNEL',
    605: 'SOAP over BEEP',
    606: 'Cray Unified Resource Manager',
    607: 'nqs',
    608: 'Sender-Initiated/Unsolicited File Transfer',
    609: 'npmp-trap',
    610: 'npmp-local',
    611: 'npmp-gui',
    612: 'HMMP Indication',
    613: 'HMMP Operation',
    614: 'SSLshell',
    615: 'Internet Configuration Manager',
    616: 'SCO System Administration Server',
    617: 'SCO Desktop Administration Server',
    618: 'DEI-ICDA',    
    619: 'Digital EVM',
    620: 'SCO WebServer Manager',
    621: 'ESCP',
    622: 'Collaborator',
    623: 'ASF Remote Management and Control Protocol',
    624: 'Crypto Manager',
    625: 'DEC DLM',
    626: 'ASIA',
    627: 'PassGo Tivoli',
    628: 'QMQP',
    629: '3Com AMP3',
    630: 'RDA',
    631: 'IPP',
    632: 'LANSERVER',
    633: 'MDQS',
    634: 'DOOM',
    635: 'Unknown',
    636: 'LDAPS',
    637: 'LANSERVER',
    638: 'MDQS',
    639: 'MSDP',
    640: 'MacOS Server Admin',
    641: 'IPX/SPX',
    642: 'IPX/SPX',
    643: 'IPX/SPX',
    644: 'IPX/SPX',
    645: 'IPX/SPX',
    646: 'LDP',
    691: 'MS Exchange Routing',
    860: 'iSCSI',
    873: 'rsync',
    902: 'VMware Server',
    989: 'FTPS (Data)',
    990: 'FTPS (Control)',
    993: 'IMAPS',
    995: 'POP3S',
    1025: 'NFS or Microsoft RPC',
    1080: 'SOCKS Proxy',
    1099: 'RMI Registry',
    1194: 'OpenVPN',
    1352: 'Lotus Notes',
    1433: 'Microsoft SQL Server',
    1434: 'SQL Monitor',
    1494: 'Citrix ICA',
    1521: 'Oracle DB',
    1701: 'L2TP',
    1720: 'H.323',
    1723: 'PPTP',
    1755: 'MMS Streaming',
    1812: 'RADIUS Authentication',
    1813: 'RADIUS Accounting',
    1863: 'MSN Messenger',
    2049: 'NFS',
    2050: 'Unknown service',
    2052: 'HTTP (Cloudflare)',
    2053: 'HTTPS (Cloudflare)',
    2082: 'cPanel',
    2083: 'cPanel (SSL)',
    2100: 'Oracle XDB',
    2222: 'DirectAdmin',
    2302: 'ArmA (Game)',
    2483: 'Oracle DB (non-SSL)',
    2484: 'Oracle DB (SSL)',
    25565: 'Minecraft Server',
    2600: 'Zebra (Routing)',
    2809: 'Corba',
    2947: 'GPSd',
    3050: 'Firebird Database',
    3074: 'Xbox Live',
    3128: 'Squid Proxy',
    3260: 'iSCSI Target',
    3306: 'MySQL',
    3389: 'RDP (Remote Desktop)',
    3689: 'iTunes Music Sharing',
    3690: 'Subversion (SVN)',
    4000: 'ICQ',
    4011: 'PXE',
    4045: 'NFS Lock Manager',
    4444: 'Metasploit / Oracle Web Listener',
    4567: 'Sinatra Web Framework',
    4664: 'Google Desktop Search',
    4672: 'eMule',
    4899: 'Radmin',
    5000: 'UPnP / Synology',
    5001: 'iperf',
    5050: 'Yahoo Messenger',
    5060: 'SIP (VoIP)',
    5061: 'SIP TLS',
    5190: 'AOL Instant Messenger',
    5222: 'XMPP / Jabber',
    5223: 'XMPP SSL',
    5432: 'PostgreSQL',
    5500: 'VNC',
    5631: 'pcAnywhere',
    5666: 'NRPE (Nagios)',
    5800: 'VNC over HTTP',
    5900: 'VNC',
    5938: 'TeamViewer',
    5985: 'WinRM (HTTP)',
    5986: 'WinRM (HTTPS)',
    8080: 'HTTP Alternate',
}


# Function to check if a port is open
def scan_port(ip, port):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.settimeout(1)
        result = sock.connect_ex((ip, port))
        if result == 0:
            service = port_names.get(port, "Unknown Service")
            print(f"{green}port {port} is open ({service}) {green}")
        sock.close()
    except socket.error:
        pass
        print(f"{red}port {port} is closed{red}")

# Function to scan a range of ports
def scan_ports(ip, start_port, end_port):
    threads = []
    for port in range(start_port, end_port + 1):
        thread = threading.Thread(target=scan_port, args=(ip, port))
        threads.append(thread)
        thread.start()

    for thread in threads:
        thread.join()

# Main function to execute the scanner
if __name__ == "__main__":
    print(magenta + "tool by hackertool" + magenta)
    target = input(cyan + "target : " + cyan)
    start_port = int(input(cyan + "port start : " + cyan))
    end_port = int(input(cyan + "end port : " + cyan))

    start_time = time.time()
    print(f"{yellow}scanning {target} from port {start_port} to {end_port} {yellow}")
    scan_ports(target, start_port, end_port)
    print(f"{green}scan done in {time.time() - start_time} seconds{green}")